{% extends "orders/checkout_base.html" %}

{% block checkout_content %}
<form method="post">
    {% csrf_token %}
    
    <!-- Order Review -->
    <div class="card mb-4">
        <div class="card-header bg-light">
            <h5 class="mb-0">Revisión del Pedido</h5>
        </div>
        <div class="card-body">
            <!-- Contact Info -->
            <div class="mb-3">
                <h6><i class="bi bi-person"></i> Información de Contacto</h6>
                <p class="mb-0">
                    {{ order.nombre }} {{ order.apellido }}<br>
                    {{ order.email }}<br>
                    {{ order.telefono }}
                </p>
            </div>
            
            <hr>
            
            <!-- Shipping Address -->
            <div class="mb-3">
                <h6><i class="bi bi-truck"></i> Dirección de Envío</h6>
                <p class="mb-0">
                    {{ order.direccion_envio }}<br>
                    {{ order.ciudad_envio }}, {{ order.codigo_postal_envio }}
                </p>
            </div>
            
            <hr>
            
            <!-- Billing Address -->
            <div class="mb-3">
                <h6><i class="bi bi-receipt"></i> Dirección de Facturación</h6>
                <p class="mb-0">
                    {{ order.direccion_facturacion }}<br>
                    {{ order.ciudad_facturacion }}, {{ order.codigo_postal_facturacion }}
                </p>
            </div>
        </div>
    </div>
    
    <!-- Payment Method -->
    <div class="card mb-4">
        <div class="card-header bg-light">
            <h5 class="mb-0">
                <i class="bi bi-credit-card"></i> Método de Pago
            </h5>
        </div>
        <div class="card-body">
            {% for choice in form.metodo_pago %}
            <div class="form-check mb-3">
                {{ choice.tag }}
                <label class="form-check-label" for="{{ choice.id_for_label }}">
                    {{ choice.choice_label }}
                    {% if choice.data.value == "contrarembolso" %}
                    <small class="text-muted d-block">
                        <i class="bi bi-info-circle"></i>
                        Pagarás al recibir el pedido en efectivo.
                    </small>
                    {% else %}
                    <small class="text-muted d-block">
                        <i class="bi bi-shield-check"></i>
                        Pago seguro procesado al instante.
                    </small>
                    {% endif %}
                </label>
            </div>
            {% endfor %}
            
            {% if form.metodo_pago.errors %}
                <div class="text-danger">{{ form.metodo_pago.errors }}</div>
            {% endif %}
        </div>
    </div>
    
    <!-- Security Badges -->
    <div class="text-center mb-4">
        <div class="d-inline-flex flex-wrap justify-content-center gap-3">
            <div class="security-badge">
                <i class="bi bi-lock-fill text-success fs-4"></i>
                <div>
                    <strong>SSL Seguro</strong><br>
                    <small class="text-muted">Encriptación 256-bit</small>
                </div>
            </div>
            <div class="security-badge">
                <i class="bi bi-credit-card text-primary fs-4"></i>
                <div>
                    <strong>Visa/Mastercard</strong><br>
                    <small class="text-muted">Aceptamos tarjetas</small>
                </div>
            </div>
            <div class="security-badge">
                <i class="bi bi-shield-check text-success fs-4"></i>
                <div>
                    <strong>Protección al Comprador</strong><br>
                    <small class="text-muted">Compra segura</small>
                </div>
            </div>
        </div>
    </div>
    
    <div class="d-grid gap-2">
        <button type="submit" class="btn btn-success btn-lg">
            <i class="bi bi-lock-fill"></i> Confirmar y Pagar €{{ order.total }}
        </button>
        <a href="{% url 'orders:checkout_billing' %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Volver
        </a>
    </div>
</form>
{% endblock %}
