{% extends 'base.html' %}

{% block title %}{{ zapato.nombre }} - Calzados Marilo{% endblock %}

{% block extra_css %}
<style>
    .product-detail-container {
        display: flex;
        gap: 40px;
        margin-top: 20px;
    }

    .product-image {
        flex: 0 0 400px;
    }

    .product-image img {
        width: 100%;
        max-width: 400px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .product-info {
        flex: 1;
    }

    .product-info h1 {
        font-size: 28px;
        color: #222;
        margin-bottom: 15px;
    }

    .product-info .description {
        font-size: 16px;
        color: #666;
        margin-bottom: 20px;
        line-height: 1.6;
    }

    .product-specs {
        margin: 20px 0;
    }

    .product-specs p {
        margin: 8px 0;
        font-size: 15px;
    }

    .product-specs strong {
        color: #333;
        min-width: 100px;
        display: inline-block;
    }

    .sizes {
        margin: 20px 0;
    }

    .sizes h5 {
        margin-bottom: 12px;
        font-size: 16px;
        font-weight: bold;
    }

    .sizes button {
        margin: 5px;
        padding: 10px 15px;
        border: 2px solid #888;
        border-radius: 5px;
        background-color: #f5f5f5;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.2s ease;
    }

    .sizes button:hover {
        background-color: #e0e0e0;
        border-color: #555;
    }

    .sizes button.active {
        background-color: #1a4cff;
        color: white;
        border-color: #1a4cff;
    }

    .sizes button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .stock-status {
        margin: 15px 0;
        font-weight: bold;
        font-size: 16px;
    }

    .stock-status.in-stock {
        color: #28a745;
    }

    .stock-status.out-of-stock {
        color: #dc3545;
    }

    .price-section {
        margin: 20px 0;
    }

    .price {
        font-size: 32px;
        font-weight: bold;
        color: #333;
    }

    .old-price {
        text-decoration: line-through;
        color: #999;
        font-size: 24px;
        margin-right: 10px;
    }

    .discounted-price {
        color: #e74c3c;
        font-size: 32px;
        font-weight: bold;
    }

    .discount-badge {
        display: inline-block;
        background-color: #e74c3c;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 14px;
        margin-left: 10px;
    }

    .actions {
        margin-top: 25px;
    }

    .actions button {
        margin-right: 15px;
        padding: 12px 30px;
        border: none;
        border-radius: 5px;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .add-cart {
        background-color: #333;
        color: white;
    }

    .add-cart:hover:not(:disabled) {
        background-color: #000;
    }

    .buy-now {
        background-color: #1a4cff;
        color: white;
    }

    .buy-now:hover:not(:disabled) {
        background-color: #0039e6;
    }

    .actions button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .product-detail-container {
            flex-direction: column;
        }

        .product-image {
            flex: 0 0 auto;
        }

        .actions button {
            display: block;
            width: 100%;
            margin: 10px 0;
        }
    }
</style>
{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Inicio</a></li>
        <li class="breadcrumb-item"><a href="{% url 'catalog:zapato_list' %}">Catálogo</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ zapato.nombre }}</li>
    </ol>
</nav>

<div class="product-detail-container">
    <div class="product-image">
        {% if zapato.imagen %}
            <img src="{{ zapato.imagen.url }}" alt="{{ zapato.nombre }}">
        {% else %}
            <img src="https://via.placeholder.com/400x400.png?text=Sin+imagen" alt="Sin imagen">
        {% endif %}
    </div>

    <div class="product-info">
        <h1>{{ zapato.nombre }}</h1>

        <p class="description">{{ zapato.descripcion }}</p>

        <div class="product-specs">
            <p><strong>Marca:</strong> {{ zapato.marca.nombre }}</p>
            <p><strong>Color:</strong> {{ zapato.color|default:"No especificado" }}</p>
            <p><strong>Material:</strong> {{ zapato.material|default:"No especificado" }}</p>
            <p><strong>Categoría:</strong> {{ zapato.categoria.nombre|default:"Sin categoría" }}</p>
            <p><strong>Género:</strong> {{ zapato.genero }}</p>
        </div>

        <div class="sizes">
            <h5>Seleccionar talla:</h5>
            {% for talla_obj in zapato.tallas.all %}
                <button data-talla="{{ talla_obj.talla }}" data-stock="{{ talla_obj.stock }}" {% if talla_obj.stock == 0 %}disabled{% endif %}>
                    Talla {{ talla_obj.talla }}
                </button>
            {% empty %}
                <p class="text-muted">No hay tallas disponibles para este producto.</p>
            {% endfor %}
        </div>

        <div class="stock-status {% if zapato.estaDisponible %}in-stock{% else %}out-of-stock{% endif %}">
            {% if zapato.estaDisponible %}
                ✓ En stock
            {% else %}
                ✗ Agotado
            {% endif %}
        </div>

        <div class="price-section">
            {% if zapato.precioOferta %}
                <span class="old-price">{{ zapato.precio|floatformat:2 }} €</span>
                <span class="discounted-price">{{ zapato.precioOferta|floatformat:2 }} €</span>
                <span class="discount-badge">-{{ zapato.descuento_porcentaje }}% OFF</span>
            {% else %}
                <span class="price">{{ zapato.precio|floatformat:2 }} €</span>
            {% endif %}
        </div>

        <div class="actions">
            <button class="add-cart" {% if not zapato.estaDisponible %}disabled{% endif %}>
                Añadir a la cesta
            </button>
            <button class="buy-now" {% if not zapato.estaDisponible %}disabled{% endif %}>
                Comprar ya
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const sizeButtons = document.querySelectorAll('.sizes button:not(:disabled)');

        sizeButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                // Remove active class from all buttons
                sizeButtons.forEach(btn => btn.classList.remove('active'));
                // Add active class to clicked button
                this.classList.add('active');
            });
        });
    });
</script>
{% endblock %}
